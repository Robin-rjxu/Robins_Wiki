---
title: 窗口采样 Window Sampling
toc: true
date: 2020-07-18 17:50:08
tags:
	- DSP
	- Signals & Systems
---

## 关键

使用窗口采样可以补偿非相关采样条件下波形的非理想性，减少频谱泄露。

窗函数的选择主要考虑主瓣宽度，最大旁瓣幅度以及旁瓣滚降率等特性，需要根据不同的应用，选择适合的折衷方案。

##  概述

### 窗口采样的原理

FFT 把采集的时域数据转换到频域时，假设从 -∞ 到 +∞ 连续采样，即假设采样到的信号为周期信号。如果不满足上述用于相干采样的条件，则可能造成信号起点/终点的非连续性，发生非相干采样。除非使用窗口采样，将采样波形与描述窗口的在时域相乘，来补偿波形的不连续性，否则频谱泄漏是不可避免的。

![Fig3](https://i.loli.net/2020/07/19/xrJjFvPlnL2BTMW.png)

![Fig5](https://i.loli.net/2020/07/19/ufRvtCjD318iEUS.png)

### 窗函数的频域响应

输入数据加窗，等效于将原始信号的频谱与窗口的频谱进行卷积。尽管通常假定不使用任何窗口进行相干采样，但实际上，使用矩形窗口对输入信号进行卷积。

窗口的频率特性是由主瓣和几个旁瓣组成的连续频谱。主瓣以输入信号的频率为中心。旁瓣从主瓣的两侧趋近零。另一方面，FFT 产生离散频谱。窗口的连续周期性频谱通过 FFT 进行采样，就像ADC在时域中对输入信号进行采样一样。在 FFT 的每个频率线中出现的是在每个 FFT 频率分量处的连续卷积频谱的值。

如果原始信号的频率成分与频率线完全匹配，如采集的数据为整数个周期的情况，只能看到频谱的主瓣，旁瓣不会出现，因为窗口频谱在主瓣两侧的谱线频率间隔处趋近于零。

如果采集数据的时间内不包含整数个周期，则窗口的连续频谱会从主瓣中心偏移分数倍的频率谱线间隔。这对应于 FFT 频谱中频率分量和频率谱线之间的差异，导致旁瓣出现在频谱中。因此，给定窗口的旁瓣特性直接影响相邻频率分量“泄漏”到相邻频率谱线中的程度。

## 窗函数的特性与选择

### 窗函数的特性

在选择适当的窗口之前，必须定义用于比较窗口特性的参数（**表1**）。

这样的特性包括窗口的-3dB和-6dB主瓣宽度，最大旁瓣幅度以及旁瓣滚降率。

给定窗口的旁瓣由两个主要特征标识：

1. 相对于主瓣峰值，最大的旁瓣高度，以分贝为单位。
2. 旁瓣滚降，定义为旁瓣峰值的渐近衰减率。

表1显示了常用窗函数的参数，这些参数通常用于在非相干采样条件下测试高速ADC的动态性能。

| 窗类型      | -3dB 主瓣宽度 | -6dB 主瓣宽度 | 最大旁瓣高度 | 旁瓣滚降率             |
| ----------- | ------------- | ------------- | ------------ | ---------------------- |
| Rectangular | 0.89 bins     | 1.21 bins     | -13.2 dB     | 20dB/decade 6dB/octave |
| Hamming     | 1.3 bins      | 1.81 bins     | -13.2 dB     | 20dB/decade 6dB/octave |
| Hanning     | 1.44 bins     | 2 bins        | -31.6 dB     | 60dB/decade 6dB/octave |
| Blackman    | 1.68 bins     | 2.35 bins     | -58 dB       | 60dB/decade 6dB/octave |

### 窗函数的选择

在选择窗函数时，应考虑带宽和旁瓣高度。 通常，旁瓣越低，信号频域中的泄漏越少。 但是，降低旁瓣也导致更多的能量集中在变宽的主瓣上。 对于频谱分离，窗函数的带宽越大，它对相同幅度和相邻频率提供的选择性越小，大的带宽导致它们一起模糊。另一方面，较低的旁瓣高度增加了不相等幅度的相邻分量之间的选择性，因为较低幅度的分量不再淹没泄漏裙中。通常，在选择正确的窗函数之前需要大量的反复试验。

不同的窗口支持不同的应用，选择正确的窗函数并非易事。假设信号包含远离感兴趣频率的强干扰频率分量，则应选择旁瓣具有高滚降率的窗口（例如 Hanning 窗）。但是，如果强干扰信号接近感兴趣的频率，则最大旁瓣电平较小的窗函数（例如，Flat Top 窗）是更合适的选择。对于具有相同幅度的相邻分量的波形，使用矩形窗或不加窗能获得最佳分析。对于单音测试，其重点是幅度精度而不是其在频率谱线的精确位置，建议使用主瓣较宽的窗口（例如Blackman窗口）。

根据应用，信号内容，FFT频谱成分和感兴趣的特性，窗函数的选择总是频谱泄漏最小化，频率/幅度精度，旁瓣减小和主瓣宽度增加之间的折衷。

## References
> - [Coherent Sampling vs. Window Sampling [Maxiam]](https://www.maximintegrated.com/en/design/technical-documents/tutorials/1/1040.html)
> - [A Tutorial in Coherent and Windowed Sampling with A/D Converters [Renesas]](https://www.renesas.com/us/en/www/doc/application-note/an9675.pdf)
> - [Window Function [Wikipedia]](https://en.wikipedia.org/wiki/Window_function)

